---
layout: article
mathjax: true
tag: buu
---

# buuæ‘¸é±¼æ—¥è®°ä¹‹åäº”

## [MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢

è®°å½•ä¸€ä¸‹ï¼Œ.htaccessç”¨æ³•

> æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯[Apache](https://baike.baidu.com/item/Apache)æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ[301é‡å®šå‘](https://baike.baidu.com/item/301é‡å®šå‘)ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚

è¿™æ ·å­ï¼Œapacheå°±ä¼šç”¨phpçš„æ–¹æ³•å»è§£æè¿™ä¸ªé©¬ï¼Œç„¶åå°±å¯ä»¥ç”¨pngé©¬æ¥getshell

```html
<FilesMatch "ma.jpg">
SetHandler application/x-httpd-php
</FilesMatch>
```

## [å®‰æ´µæ¯ 2019]easy_serialize_php

ä»”ç»†æ€è€ƒäº†æŒºä¹…çš„

ä¸»è¦æ˜¯åˆ©ç”¨wafæ¥è¿›è¡Œååºåˆ—åŒ–çš„é€ƒåŒ¿

é¦–å…ˆæ˜¯è¿™ä¸ª[$_SESSEION](https://runoob.com/php/php-sessions.html)çš„ç†è§£

å°±æŠŠå®ƒç†è§£æˆæ™®é€šçš„å¯¹è±¡å°±è¡Œ

```php
 <?php

$function = @$_GET['f'];

function filter($img){
    $filter_arr = array('php','flag','php5','php4','fl1g');
    $filter = '/'.implode('|',$filter_arr).'/i';
    return preg_replace($filter,'',$img);
}


if($_SESSION){
    unset($_SESSION);
}

$_SESSION["user"] = 'guest';
$_SESSION['function'] = $function;

extract($_POST);//ç›´æ¥å°† $_POST å’Œ $_GET ä¸­çš„å˜é‡è§£æå‡ºæ¥ï¼Œä¸éœ€è¦æ‰‹å·¥èµ‹å€¼å¤„ç†ã€‚ä¹Ÿæ˜¯å› ä¸ºè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥post $_SESSION,èµ‹å€¼å‡ºç©ºå€¼ç„¶åè¿›è¡Œååºåˆ—åŒ–

if(!$function){
    echo '<a href="index.php?f=highlight_file">source_code</a>';
}

if(!$_GET['img_path']){
    $_SESSION['img'] = base64_encode('guest_img.png');
}else{
    $_SESSION['img'] = sha1(base64_encode($_GET['img_path']));
    //ä¸èƒ½åœ¨è¿™ä¸ªifåŠ å¯†ï¼Œä¸ç„¶åé¢decodeå°±decodeä¸ªå¯‚å¯
}

$serialize_info = filter(serialize($_SESSION));

if($function == 'highlight_file'){
    highlight_file('index.php');
}else if($function == 'phpinfo'){
    eval('phpinfo();'); //maybe you can find something in here!
}else if($function == 'show_image'){
    $userinfo = unserialize($serialize_info);
    echo file_get_contents(base64_decode($userinfo['img']));
} 
```

phpinfoå¯ä»¥æŸ¥åˆ°d0ge_flag.php

å…·ä½“å°±æ˜¯https://my.oschina.net/u/4330242/blog/3312588 æ„Ÿè§‰è‡ªå·±è¯´çš„ä¸å¦‚åˆ«äººå¥½ï¼Œç®—äº†ï¼Œè¿˜æ˜¯ç™½å«–æ¥çš„æ–¹ä¾¿

## [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox

ä¸€çœ‹CISCNå°±çŸ¥é“å¹¶ä¸ç®€å•

tagé‡Œæœ‰pharï¼Œå°±å»çœ‹äº†ä¸‹è¿™æ˜¯å•¥

https://xz.aliyun.com/t/2715#toc-8

ç†è§£äº†ä¸€ä¸‹,é‡Œé¢å±…ç„¶è¿˜æœ‰ååºåˆ—åŒ–ï¼ˆå­¦åˆ°äº†å­¦åˆ°äº†ï¼‰

ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œç‚¹../../index.phpå°±å¯èƒ½æ‹¿åˆ°é™¤äº†flagçš„å…¨éƒ¨å†…å®¹